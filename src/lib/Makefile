# =====================================================================================================================
# === KasmOS (c)2025+ Laurent Menten (laurent.menten@gmail.com) === GNU Lesser General Public License v3.0 (LGPLv3) ===
# =====================================================================================================================

ifndef KASMOS_DIR
$(error KASMOS_DIR is not properly defined. Use 'make KASMOS_DIR=/path/to/kasmos')
endif

include $(KASMOS_DIR)/Makefile.rules

# =====================================================================================================================
# =
# =====================================================================================================================

SUBDIRS := $(shell find . -mindepth 1 -maxdepth 1 -type d ! -name 'build' ! -name '.git' -exec test -e "{}/Makefile" ';' -print | sed 's|^\./||')

.PHONY: all $(SUBDIRS) clean clobber

# =====================================================================================================================
# =
# =====================================================================================================================

all: $(SUBDIRS)

$(SUBDIRS):
	@$(MAKE) -C $@ all

# =====================================================================================================================
# =
# =====================================================================================================================

clean:
	@for d in $(SUBDIRS); do \
		$(MAKE) -C $$d clean || true; \
	done
